<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google" content="notranslate" />
    <title>New Freeway Admin</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  </head>
  <body>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

    <script>
      // 3. è¨­å®š CMS åƒæ•¸
      const config = {
        backend: {
  name: "github", // æ”¹ç‚º github
  repo: "ä½ çš„GitHubå¸³è™Ÿ/ä½ çš„å€‰åº«åç¨±", // ä¾‹å¦‚: "newfreeway/my-site"
  branch: "main",
},
        load_config_file: false,
        media_folder: "public/images/uploads",
        public_folder: "/images/uploads",
        collections: [
          {
            name: "products",
            label: "é›»è…¦ç”¢å“",
            folder: "src/content/products",
            create: true,
            slug: "{{slug}}",
            fields: [
              { label: "ç”¢å“åç¨±", name: "title", widget: "string" },
              { label: "è™•ç†å™¨ (CPU) ðŸ§ ", name: "cpu", widget: "string" },
              { label: "é¡¯ç¤ºå¡ (GPU) ðŸŽ®", name: "gpu", widget: "string" },
              { label: "åƒ¹æ ¼", name: "price", widget: "number" },
              { label: "è©³ç´°æè¿°", name: "body", widget: "markdown" }
            ],
          },
        ],
      };

      // 4. é—œéµï¼šç­‰å¾… Identity åˆå§‹åŒ–å¾Œå†å•Ÿå‹• CMS
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", (user) => {
          if (!user) {
            window.netlifyIdentity.on("login", () => {
              document.location.href = "/admin/";
            });
          }
          // Identity æº–å‚™å¥½äº†ï¼Œå•Ÿå‹• CMS
          CMS.init({ config });
        });
      } else {
        // å¦‚æžœ Identity æ²’è¼‰å…¥ï¼Œç›´æŽ¥å•Ÿå‹•
        CMS.init({ config });
      }
    </script>
  </body>
</html>
